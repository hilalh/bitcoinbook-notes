# Chapter 02 - How bitcoin works?

- Unlike traditional banking, bitcoin is based on decentralized trust.

## 2.1 Trnasactions, blocks, and mining on the network
- We will start by talking about transactions, blocks, and mining.

## 2.2 Bitcoin transactions
- **What's a transaction in the network?**
    -  In simple terms, a transaction tells the network that the owner of some bitcoin value has authorized the transfer of that value to another owner.
    -  Like lines in double-entry book-keeping ledger.
    -  **What does each transaction line include?**
        -  Each line include one or more "inputs" (debits)
        -  Each line include one or more "outputs" (credits)
        -  Proof of ownership for each amount of bitcoin
- Importantly, the change address does not have to be the same address as that of the input and for privacy reasons is often a new address from the owner’s wallet.

- inputs, like currency notes, cannot be divided

- Problem: Overhead on network, have client merge their own inputs, and cut upon outputs from average transaction

- Unless the wallet can aggregate inputs in such a way to exactly match the desired payment plus transaction fees, the wallet will need to generate some change. This is very similar to how people handle cash

- Solution is in the wallet

- Transactions like these are sometimes generated by wallet applications to clean up lots of smaller amounts that were received as change for payments.

- This type of transaction is sometimes used by commercial entities to distribute funds, such as when processing payroll payments to multiple employees.

- Or when an exchange wallet, makes payments to multiple individual user’s wallets

- Alice’s wallet application will first have to find inputs that can pay for the amount she wants to send to Bob. Most wallets keep track of all the available outputs belonging to addresses in the wallet. Therefore, Alice’s wallet would contain a copy of the transaction output from Joe’s transaction, which was created in exchange for cash (see the section called “Getting Your First Bitcoin”). A bitcoin wallet application that runs as a full-node client actually contains a copy of every unspent output from every transaction in the blockchain. This allows a wallet to construct transaction inputs as well as quickly verify incoming transactions as having correct inputs. However, because a full-node client takes up a lot of disk space, most user wallets run "lightweight" clients that track only the user’s own unspent outputs.

- Essentially, Alice’s wallet breaks her funds into two payments: one to Bob and one back to herself. She can then use (spend) the change output in a subsequent transaction.

- Any bitcoin node that receives a valid transaction it has not seen before will immediately forward it to all other nodes to which it is connected, a propagation technique known as flooding.

- A merchant may accept a valid small-value transaction with no confirmations, with no more risk than a credit card payment made without an ID or a signature, as merchants routinely accept today.

- It does not become part of the blockchain until it is verified and included in a block by a process called mining

- It = the transaction made user (Alice)

- The mining process serves two purposes in bitcoin

- mining provides security for bitcoin transactions by rejecting invalid or malformed transactions.

- Mining creates new bitcoin in each block, almost like a central bank printing new money.

- the reward will only be collected if the miner has correctly validated all the transactions, to the satisfaction of the rules of consensus.

- A good way to describe mining is like a giant competitive game of sudoku that resets every time someone finds a solution and whose difficulty automatically adjusts so that it takes approximately 10 minutes to find a solution

- The "puzzle" used in bitcoin is based on a cryptographic hash and exhibits similar characteristics: it is asymmetrically hard to solve but easy to verify, and its difficulty can be adjusted.

- he so-called Proof-of-Work (PoW), requires quadrillions of hashing operations per second across the entire bitcoin network.

- The algorithm for Proof-of-Work involves repeatedly hashing the header of the block and a random number with the SHA256 cryptographic algorithm until a solution matching a predetermined pattern emerges.

- The first miner to find such a solution wins the round of competition and publishes that block into the blockchain.

- As miners construct a new block, they add unverified transactions from this pool to the new block and then attempt to prove the validity of that new block, with the mining algorithm (Proof-of-Work)

- Transactions are added to the new block, prioritized by the highest-fee transactions first and a few other criteria.

- He immediately creates a new block, fills it with transactions and the fingerprint of the previous block, and starts calculating the Proof-of-Work for the new block

- Each miner includes a special transaction in his block, one that pays his own bitcoin address the block reward

- If he finds a solution that makes that block valid, he "wins" this reward because his successful block is added to the global blockchain and the reward transaction he included becomes spendable.

- Once validated by the mining software it was included in a new block, called a candidate block, generated by Jing’s mining pool.

- Each block mined on top of the one containing the transaction counts as an additional confirmation for Alice’s transaction

- As the blocks pile on top of each other, it becomes exponentially harder to reverse the transaction,

- Over time, as the "height" in blocks increases, so does the computation difficulty for each block and the chain as a whole.

- By convention, any block with more than six confirmations is considered irrevocable,

- because it would require an immense amount of computation to invalidate and recalculate six blocks.

- embedded in the blockchain as part of a block, it is part of the distributed ledger of bitcoin and visible to all bitcoin applications

- Full-node clients can track the source of the funds from the moment the bitcoin were first generated in a block,

- incrementally from transaction to transaction, until they reach Bob’s address.

- Lightweight clients can do what is called a simplified payment verification

- Most likely, Bob’s bitcoin software will aggregate many small payments into a larger payment, perhaps concentrating all the day’s bitcoin revenue into a single transaction.